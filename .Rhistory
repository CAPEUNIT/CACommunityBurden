myDrive <- "E:"
myPlace <- paste0(myDrive,"/0.CBD/myCBD")
upPlace <- paste0(myDrive,"/0.CBD/myUpstream")
install.packages("fs")
library(fs)
updateR()
install.packages("installr")
library(installr)
updateR()
install.packages("fs")
library(fs)
oshpdHD <- readRDS(file=path(upPlace,"upData/oshpdHD.rds"))
myDrive <- "H:"
myPlace <- paste0(myDrive,"/0.CBD/myCBD")
upPlace <- paste0(myDrive,"/0.CBD/myUpstream")
library(fs)
oshpdHD <- readRDS(file=path(upPlace,"upData/oshpdHD.rds"))
View(oshpdHD)
tWork   <- oshpdHD %>% mutate(mdc = as.numeric(mdc)) %>%
group_by(mdc) %>%
summarise(tCount = n(),
tBucks = sum(charge)) %>%
gather(tCount, tBucks, key = "count_charges", value = "number")
library(tidyverse)
library(ggplot2)
tWork   <- oshpdHD %>% mutate(mdc = as.numeric(mdc)) %>%
group_by(mdc) %>%
summarise(tCount = n(),
tBucks = sum(charge)) %>%
gather(tCount, tBucks, key = "count_charges", value = "number")
View(tWork)
View(oshpdHD)
library(readxl)
oshpdMdcMap <- read_excel(path(myPlace,"myInfo/App_I_MDC_PDD.xlsx"), sheet="v32.0 ",skip=4)
View(oshpdMdcMap)
names(oshpdMdcMap)[1] <- "mdc"
names(oshpdMdcMap)[2] <- "MDC"
View(oshpdMdcMap)
tWork <- full_join(oshpdMdcMap,tWork,by="mdc")
tWork <- tWork %>% select(-mdc)
tWork <- as.data.frame((tWork))
View(tWork)
ggplot(data = tWork, aes(x = MDC, y = number, fill = count_charges)) +  coord_flip() +
geom_bar(stat = "identity" ) +
facet_grid(. ~ count_charges,scales="free_x")
View(oshpdHD)
oshpdHD0  <- haven::read_sas("S:\\CDCB\\Demonstration Folder\\Data\\OSHPD\\PDD\\2016\\cdph_pdd_ssn2016.sas7bdat")
View(oshpdHD0)
oshpdH1   <- select(oshpdHD0,admtyr,patcnty,patzip,sex,agyrdsch,mdc,diag_p,charge, odiag1-odiag24)
oshpdH1   <- select(oshpdHD0,admtyr,patcnty,patzip,sex,agyrdsch,mdc,diag_p,charge, odiag1:odiag24)
View(oshpdH1)
oshpdH1   <- select(oshpdHD0,admtyr,patcnty,patzip,sex,agyrdsch,mdc,diag_p,charge, odiag1, odiag2, odiag3, odiag4,
odiag5, odiag6, odiag7, odiag8, odiag9, odiag10, odiag11, odiag12, odiag13, odiag14, odiag15,
odiag16, odiag17, odiag18, odiag19, odiag20, odiag21, odiag22, odiag23,odiag24)
oshpdH1   <- select(oshpdHD0,admtyr,patcnty,patzip,sex,agyrdsch,mdc,charge, race_grp, diag_p, odiag1, odiag2, odiag3, odiag4,
odiag5, odiag6, odiag7, odiag8, odiag9, odiag10, odiag11, odiag12, odiag13, odiag14, odiag15,
odiag16, odiag17, odiag18, odiag19, odiag20, odiag21, odiag22, odiag23,odiag24,
poa_p, opoa1, opoa2, opoa3, opoa4, opoa5, opoa6, opoa7, opoa8, opoa9, opoa10, opoa11, opoa12, opoa13,
opoa14, opoa15, opoa16, opoa17, opoa18, opoa19, opoa20, opoa21, opoa22, opoa23, opoa24,
proc_p, oproc1, oproc2, oproc3, oproc4, oproc5, oproc6, oproc7, oproc8, oproc9, oproc10, oproc11, oproc12,
oproc13, oproc14, oproc15, oproc16, oproc17, oproc18, oproc19, oproc20, oproc21, oproc22, oproc23, oproc24)
oshpdH1   <- select(oshpdHD0,admtyr,patcnty,patzip,sex,agyrdsch,mdc,charge, race_grp, diag_p, odiag1, odiag2, odiag3, odiag4,
odiag5, odiag6, odiag7, odiag8, odiag9, odiag10, odiag11, odiag12, odiag13, odiag14, odiag15,
odiag16, odiag17, odiag18, odiag19, odiag20, odiag21, odiag22, odiag23,odiag24,
poa_p, opoa1, opoa2, opoa3, opoa4, opoa5, opoa6, opoa7, opoa8, opoa9, opoa10, opoa11, opoa12, opoa13,
opoa14, opoa15, opoa16, opoa17, opoa18, opoa19, opoa20, opoa21, opoa22, opoa23, opoa24,
proc_p, oproc1, oproc2, oproc3, oproc4, oproc5, oproc6, oproc7, oproc8, oproc9, oproc10, oproc11, oproc12,
oproc13, oproc14, oproc15, oproc16, oproc17, oproc18, oproc19, oproc20)
View(oshpdH1)
View(oshpdHD0)
library(tidyverse)
library(ggplot2)
library(haven)
library(fs)
library(readxl)
oshpdH1   <- select(oshpdHD0,diag_p, odiag1, odiag2, odiag3, odiag4, odiag5, odiag6, odiag7, odiag8, odiag9, odiag19, odiag11, odiag12, odiag13, odiag14, odiag15, odiag16, odiag17, odiag18, odiag19, odiag20, odiag21, odiag22, odiag23, odiag24, mdc, charge, pay_cat, pay_type, admtyr, patcnty, patzip, sex, agyrdsch, race_grp)
saveRDS(oshpdHD1, file=path(upPlace,"upData/oshpdHD2016_subset.rds"))
oshpdHD1   <- select(oshpdHD0,diag_p, odiag1, odiag2, odiag3, odiag4, odiag5, odiag6, odiag7, odiag8, odiag9, odiag19, odiag11, odiag12, odiag13, odiag14, odiag15, odiag16, odiag17, odiag18, odiag19, odiag20, odiag21, odiag22, odiag23, odiag24, mdc, charge, pay_cat, pay_type, admtyr, patcnty, patzip, sex, agyrdsch, race_grp)
saveRDS(oshpdHD1, file=path(upPlace,"upData/oshpdHD2016_subset.rds"))
oshpd16_subset <- readRDS(file=path(upPlace,"upData/oshpdHD2016_subset.rds"))
library(tidyverse)
library(ggplot2)
library(haven)
library(fs)
library(readxl)
myDrive <- "H:"  #Change this the drive where your data is located--in my case, the H: drive
myPlace <- paste0(myDrive,"/0.CBD/myCBD")
upPlace <- paste0(myDrive,"/0.CBD/myUpstream")
oshpdHD0  <- read_sas("S:\\CDCB\\Demonstration Folder\\Data\\OSHPD\\PDD\\2016\\cdph_pdd_ssn2016.sas7bdat")
oshpdHD1   <- select(oshpdHD0,diag_p, odiag1, odiag2, odiag3, odiag4, odiag5, odiag6, odiag7, odiag8, odiag9, odiag19, odiag11, odiag12, odiag13, odiag14, odiag15, odiag16, odiag17, odiag18, odiag19, odiag20, odiag21, odiag22, odiag23, odiag24, mdc, charge, pay_cat, pay_type, admtyr, patcnty, patzip, sex, agyrdsch, race_grp)
#saving rds file--only needs to be run once to initially create the file
saveRDS(oshpdHD1, file=path(upPlace,"upData/oshpdHD2016_subset.rds"))
library(tidyverse)
library(ggplot2)
library(haven)
library(fs)
library(readxl)
myDrive <- "H:"  #Change this the drive where your data is located--in my case, the H: drive
myPlace <- paste0(myDrive,"/0.CBD/myCBD")
upPlace <- paste0(myDrive,"/0.CBD/myUpstream")
oshpdHD0  <- read_sas("S:\\CDCB\\Demonstration Folder\\Data\\OSHPD\\PDD\\2016\\cdph_pdd_ssn2016.sas7bdat")
oshpdHD1   <- select(oshpdHD0,diag_p, odiag1, odiag2, odiag3, odiag4, odiag5, odiag6, odiag7, odiag8, odiag9, odiag19, odiag11, odiag12, odiag13, odiag14, odiag15, odiag16, odiag17, odiag18, odiag19, odiag20, odiag21, odiag22, odiag23, odiag24, mdc, charge, pay_cat, pay_type, admtyr, patcnty, patzip, sex, agyrdsch, race_grp)
#saving rds file--only needs to be run once to initially create the file
saveRDS(oshpdHD1, file=path(upPlace,"upData/oshpdHD2016_subset.rds"))
oshpd16_subset <- readRDS(file=path(upPlace,"upData/oshpdHD2016_subset.rds")) #creating an rds file of oshpdHD, which is the subset of OSHPD data with only the selected variables
icd_map <- read_excel(path(myPlace, "myInfo/gbd.ICD.Map.xlsx"))
View(icd_map)
getwd()
